unit factLibX;
{$Z4,A+}

interface

{
 -08-123456789ABCDEF0
 -10-123456789ABCDEF0123456789ABCDEF0
 -20-123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0
 -40-123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0
 -80-123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0
 -10-123456789ABCDEF0123456789ABCDEF0

 ->-FEDCBA9876543210FEDCBA9876543210FEDCBA9876543210FEDCBA9876543210--------------12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890
 1A:         14D9849EA37EEAC91800000                  26:403291461126605635584000000
 1B:        232F0FCBB3E62C3358800000                  27:10888869450418352160768000000
 1C:       3D925BA47AD2CD59DAE000000                  28:304888344611713860501504000000
 1D:      6F99461A1E9E1432DCB6000000                  29:8841761993739701954543616000000
 1E:     D13F6370F96865DF5DD54000000                  30:265252859812191058636308480000000
 1F:   1956AD0AAE33A4560C5CD2C000000                  31:8222838654177922817725562880000000
 20:  32AD5A155C6748AC18B9A580000000                  32:263130836933693530167218012160000000
 21: 688589CC0E9505E2F2FEE5580000000                  33:8683317618811886495518194401280000000
 22:DE1BC4D19EFCAC82445DA75B00000000                  34:295232799039604140847618609643520000000
 ->-FEDCBA9876543210FEDCBA9876543210FEDCBA9876543210FEDCBA9876543210--------------12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890
 23:      1E5DCBE8A8BC8B95CF58CDE17100000000          35:10333147966386144929666651337523200000000
 24:     44530ACB7BA83A111287CF3B3E400000000          36:371993326789901217467999448150835200000000
 25:    9E0008F68DF506477ADA0F38FFF400000000          37:13763753091226345046315979581580902400000000
 26:  1774015499125EEE9C3C5E4275FE3800000000          38:523022617466601111760007224100074291200000000
 27: 392AC33E351CC7659CD325C1FF9BA8800000000          39:20397882081197443358640281739902897356800000000
 28:8EEAE81B84C7F27E080FDE64FF05254000000000          40:815915283247897734345611269596115894272000000000
 -^-FEDCBA9876543210FEDCBA9876543210FEDCBA9876543210FEDCBA9876543210--------------12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890
 29:      16E39F2C684405D62F4A8A9E2CD7D2F74000000000  41:33452526613163807108170062053440751665152000000000
 2A:     3C1581D491B28F523C23ABDF35B689C908000000000  42:1405006117752879898543142606244511569936384000000000
 2B:    A179CCEB478FE12D019FDDE7E05A924C458000000000  43:60415263063373835637355132068513997507264512000000000
 2C:  1BC0EF38704CBAB3BC477A23DA8F91251BF20000000000  44:2658271574788448768043625811014615890319638528000000000
 2D: 4E0EA0CEBBD7CD1981890784D6B3C8385E98A0000000000  45:119622220865480194561963161495657715064383733760000000000
 2E:E06A0E525C0C6DA95469F59DE944DFA20FF6CC0000000000  46:5502622159812088949850305428800254892961651752960000000000
 ->-FEDCBA9876543210FEDCBA9876543210FEDCBA9876543210FEDCBA9876543210--------------12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890
 2F:              293378A11EE64822167F7417FDD3A50EC0EE4F740000000000  47:258623241511168180642964355153611979969197632389120000000000
 30:             7B9A69E35CB2D866437E5C47F97AEF2C42CAEE5C00000000000  48:12413915592536072670862289047373375038521486354677760000000000
 31:           17A88E4484BE3B6B92EB2FA9C6C087C778C8D79F9C00000000000  49:608281864034267560872252163321295376887552831379210240000000000
 32:          49EEBC961ED279B02B1EF4F28D19A84F5973A1D2C7800000000000  50:30414093201713378043612608166064768844377641568960512000000000000
 33:         EBA8F91E823EE3E18972ACC521C1C87CED2093CFDBE800000000000  51:1551118753287382280224243016469303211063259720016986112000000000000
 34:       2FDE529A3274C649CFEB4B180ADB5CB9602A9E0638AB2000000000000  52:80658175170943878571660636856403766975289505440883277824000000000000
 35:      9E90719EC722D0D480BB68BFA3F6A3260E8D2B749BB6DA000000000000  53:4274883284060025564298013753389399649690343788366813724672000000000000
 -^-FEDCBA9876543210FEDCBA9876543210FEDCBA9876543210FEDCBA9876543210--------------12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890
 36:    217277F77E01580CD32788186C96066A0711C72A98D891FC000000000000  54:230843697339241380472092742683027581083278564571807941132288000000000000
 37:   72F97C62C1249EAC15D7E3D3F543B60C784D1CA26D6875D24000000000000  55:12696403353658275925965100847566516959580321051449436762275840000000000000
 38: 192693359A4002B5A4C739D65DA6CFD2BA50DE4387EED9C5FE0000000000000  56:710998587804863451854045647463724949736497978881168458687447040000000000000
 39:59996C6EF58409A71B05BE0BADA2445EB7C017D09442E7D158E0000000000000  57:40526919504877216755680601905432322134980384796226602145184481280000000000000
 ->-FEDCBA9876543210FEDCBA9876543210FEDCBA9876543210FEDCBA9876543210--------------12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890

 PERMUTASI
 =========
 01:01                           01:1
 02:02                           02:2
 03:06                           03:6
 04:18                           04:24
 05:78                           05:120
 06:02D0                         06:720
 07:13B0                         07:5040
 08:9D80                         08:40320
 09:58980                        09:362880
 0A:375F00                       10:3628800
 0B:2611500                      11:39916800
 0C:1C8CFC00                     12:479001600
 ->-12345678------------------------123456789012345678901234567890
 0D:17328CC00                    13:6227020800
 0E:144C3B2800                   14:87178291200
 ->-12345678------------------------123456789012345678901234567890
 0F:13077775800                  15:1307674368000
 10:130777758000                 16:20922789888000
 11:1437EEECD8000                17:355687428096000
 12:16BEECCA730000               18:6402373705728000
 13:1B02B9306890000              19:121645100408832000
 14:21C3677C82B40000             20:2432902008176640000
 ->-123456789ABCDEF0----------------123456789012345678901234567890
 15:2C5077D36B8C40000            21:51090942171709440000
 16:3CEEA4C2B3E0D80000           22:1124000727777607680000
 17:57970CD7E2933680000          23:25852016738884976640000
 18:83629343D3DCD1C00000         24:620448401733239439360000
 19:CD4A0619FB0907BC00000        25:15511210043330985984000000
 ->-123456789ABCDEF0----------------123456789012345678901234567890
 1A:14D9849EA37EEAC91800000                                                    26:403291461126605635584000000
 1B:232F0FCBB3E62C3358800000                                                   27:10888869450418352160768000000
 1C:3D925BA47AD2CD59DAE000000                                                  28:304888344611713860501504000000
 1D:6F99461A1E9E1432DCB6000000                                                 29:8841761993739701954543616000000
 1E:D13F6370F96865DF5DD54000000                                                30:265252859812191058636308480000000
 1F:1956AD0AAE33A4560C5CD2C000000                                              31:8222838654177922817725562880000000
 20:32AD5A155C6748AC18B9A580000000                                             32:263130836933693530167218012160000000
 21:688589CC0E9505E2F2FEE5580000000                                            33:8683317618811886495518194401280000000
 22:DE1BC4D19EFCAC82445DA75B00000000                                           34:295232799039604140847618609643520000000
 ->-123456789ABCDEF0123456789ABCDEF0----------------------------------------------123456789012345678901234567890123456789012345678901234567890
 23:1E5DCBE8A8BC8B95CF58CDE17100000000                                         35:10333147966386144929666651337523200000000
 24:44530ACB7BA83A111287CF3B3E400000000                                        36:371993326789901217467999448150835200000000
 25:9E0008F68DF506477ADA0F38FFF400000000                                       37:13763753091226345046315979581580902400000000
 26:1774015499125EEE9C3C5E4275FE3800000000                                     38:523022617466601111760007224100074291200000000
 27:392AC33E351CC7659CD325C1FF9BA8800000000                                    39:20397882081197443358640281739902897356800000000
 28:8EEAE81B84C7F27E080FDE64FF05254000000000                                   40:815915283247897734345611269596115894272000000000
 -^-123456789ABCDEF0123456789ABCDEF0----------------------------------------------123456789012345678901234567890123456789012345678901234567890
 29:16E39F2C684405D62F4A8A9E2CD7D2F74000000000                                 41:33452526613163807108170062053440751665152000000000
 2A:3C1581D491B28F523C23ABDF35B689C908000000000                                42:1405006117752879898543142606244511569936384000000000
 2B:A179CCEB478FE12D019FDDE7E05A924C458000000000                               43:60415263063373835637355132068513997507264512000000000
 2C:1BC0EF38704CBAB3BC477A23DA8F91251BF20000000000                             44:2658271574788448768043625811014615890319638528000000000
 2D:4E0EA0CEBBD7CD1981890784D6B3C8385E98A0000000000                            45:119622220865480194561963161495657715064383733760000000000
 2E:E06A0E525C0C6DA95469F59DE944DFA20FF6CC0000000000                           46:5502622159812088949850305428800254892961651752960000000000
 ->-123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0------------------------------123456789012345678901234567890123456789012345678901234567890
 2F:293378A11EE64822167F7417FDD3A50EC0EE4F740000000000                         47:258623241511168180642964355153611979969197632389120000000000
 30:7B9A69E35CB2D866437E5C47F97AEF2C42CAEE5C00000000000                        48:12413915592536072670862289047373375038521486354677760000000000
 31:17A88E4484BE3B6B92EB2FA9C6C087C778C8D79F9C00000000000                      49:608281864034267560872252163321295376887552831379210240000000000
 32:49EEBC961ED279B02B1EF4F28D19A84F5973A1D2C7800000000000                     50:30414093201713378043612608166064768844377641568960512000000000000
 33:EBA8F91E823EE3E18972ACC521C1C87CED2093CFDBE800000000000                    51:1551118753287382280224243016469303211063259720016986112000000000000
 34:2FDE529A3274C649CFEB4B180ADB5CB9602A9E0638AB2000000000000                  52:80658175170943878571660636856403766975289505440883277824000000000000
 35:9E90719EC722D0D480BB68BFA3F6A3260E8D2B749BB6DA000000000000                 53:4274883284060025564298013753389399649690343788366813724672000000000000
 -^-123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0------------------------------123456789012345678901234567890123456789012345678901234567890
 36:217277F77E01580CD32788186C96066A0711C72A98D891FC000000000000               54:230843697339241380472092742683027581083278564571807941132288000000000000
 37:72F97C62C1249EAC15D7E3D3F543B60C784D1CA26D6875D24000000000000              55:12696403353658275925965100847566516959580321051449436762275840000000000000
 38:192693359A4002B5A4C739D65DA6CFD2BA50DE4387EED9C5FE0000000000000            56:710998587804863451854045647463724949736497978881168458687447040000000000000
 39:59996C6EF58409A71B05BE0BADA2445EB7C017D09442E7D158E0000000000000           57:40526919504877216755680601905432322134980384796226602145184481280000000000000
 ->-123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0--------------12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890
 3A:144CC291239FEA2FDC1F4D0EA556C37D75A18565419728856E22C0000000000000         58:2350561331282878571829474910515074683828862318181142924420699914240000000000000
 3B:4ADB0D77335DAF907BB36C2601AFF0DEA1C39BE561DD656C0620240000000000000        59:138683118545689835737939019720389406345902876772687432540821294940160000000000000
 3C:118B5727F009F525DCFE0D58E8653C742DE9D889C2EFE3C5516F88700000000000000      60:8320987112741390144276341183223364380754172606361245952449277696409600000000000000
 3D:42E33C484325F6A05A8892E2F601F67AEF0B898D373294604679382B00000000000000     61:507580213877224798800856812176625227226004528988036003099405939480985600000000000000
 3E:10330899804331BAD5ED1392F79479B1C5E4CB50335E3FEF51115B9A6A00000000000000   62:31469973260387937525653122354950764088012280797258232192163168247821107200000000000000
 3F:3FC8F1DC690893CFAA557D12AED89F2BFB34E08BCA431BBE4F3458B001600000000000000  63:1982608315404440064116146708361898137544773690227268628106279599612729753600000000000000
 40:FF23C771A4224F3EA955F44ABB627CAFECD3822F290C6EF93CD162C0058000000000000000 64:126886932185884164103433389335161480802865516174545192198801894375214704230400000000000000
 41:40C815A3DAACB61EE8FED306F99401A8AB21B40DF96C282D48712A12C1658000000000000000
 42:10B395943E6086F3F811B267CC58286D7C1EB06B9A4DE25BACAD2CD8D5DC2B0000000000000000
 43:45F0025CC534351D9ECA1B12A7B1294A77C082C2962623DFE3152BCBFF89F410000000000000000
 -^-123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0---------------------------------------------------12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890
 44:1293C0A0A461DE1BDE2DAF30F48B0EF7C7CF22BBAFE2218778519FA22FE0A4D440000000000000000
 45:501D2EB4C4E60DD82E2503831E97B08C8DAD45C9667F309836E0006B6E78C6D3540000000000000000
 46:15E7FAC56DD6E7C91C9E1EF5DA5D7A466EBD61151206C7499F01401D6035065DC8F80000000000000000
 47:613568CC1769A48C6EFDA962F8FECE988B685ECD7FFE1456B1958C825AEB4C402BCC80000000000000000
 48:1B5705796695B6477F3757A3D607AA1AE7355AA9CBFF75B861F20F84A9922D720C518400000000000000000
 49:7CBD08F9E40B0FA6346C7FDB8082F81ABEE36DA6B2BD89193EE066CD45AAEF585833EA400000000000000000
 4A:240EA4983BEB32860B275CF57325DBB7BB2DBDB22FAAC9A14C2CDDB75623692F897F01B6800000000000000000
 4B:A904A38998DE7CD4544883BE8BC175ED3D6669333F70912415124F4B63C5FD0ED48358077800000000000000000
 4C:322D608CD9620D0F0905871C917D6F026E3A673B36D56B16B6416F8A619EC7206716FE2237A000000000000000000
 4D:F17A60A5D627DED85B6A9A397C2BA63BB27910CCF7E3135D4D1AE8C9F5CC1E4BF01EA704ABB2000000000000000000
 4E:49934972874025E5EBDA7AFD83D54CA63060E31E73872FE66D7E32ED88E4313B232956E36C503C000000000000000000
 ->-123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0-----------------------------------12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890
 4F:16B473AA57BCCBB1F3C86BF43BAED2A748EDE61665A6B7C81BC9F1B74D3E6B313FD9C1D02E6CC284000000000000000000
 50:71864253B6AFFA79C2EA1BC52A6A1D446CA57E6FFC4196E88AF1B894823817F63F40C910E81FCC940000000000000000000
 -^-123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0---------------------------------------------------12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890
 51:23EB7AFC7CCDAE4086AC12C9626B9342A6605D016ED0C0BF93F67B66FD33BF94EA037F9E59720FBAD40000000000000000000
 52:B816D64DFF9E1D0AB231E048186752B594ADDCA757EDDBD5D64F386FD1A935DB2F51EE0B8A68909D7E80000000000000000000
 53:3BAF677B49E0436A77C62BB75FE97FD0DF345E8A41821E46547BAF4C40F9DC761057902DBDDFE6E3100380000000000000000000
 54:13958DF4743D961EEF4D06582B789DF0893D2F055D7EB1EF13B895850551FC56BD5CBB4F024D77C281412600000000000000000000
 55:680A8222A9872D84574931B466F0C70DD91509CC80B1114618C49A52AC438C8CCDFCA313BC3B8C394EAA19E00000000000000000000
 56:22F387B7A4F3694A755296B29A94E2DEA6ED114AB33B7BCD8C520BD7C5DEB1374D32DEC8A13C011B406D24B1400000000000000000000
 57:BE0C31F690EB8C84DDF1136B2889919AABA90E062E93712DAAFE206543EAE39CB3C49B62ECB646042E517783CC00000000000000000000
 58:4154312CC1D0F84DAC4ADEACD5EF4A0D2B021CD22002AEE7B2C75B22CF58BE3DDDCB956A015EA8116FEC01154E2000000000000000000000
 ->-123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0-------------------12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890
 59:16B645188F61A65300E6076A166030BE93F3BC050D20EECE8D274EAF1A15DA23821BC6F1DA79E86E0FE90C6068292000000000000000000000
 5A:7FC144AA26854792E50DE9B4BDDD1230003B019C69D93F49D9FD1A98F2BAEB07BBDC3F106CEDBB6B197EE59E49E754000000000000000000000
 5B:2D69B3687BB16071376BF2133F7D95771014F99299A0397F407CF8745E48718BBFC74A6AD6B8819F12101B9F44453ADC000000000000000000000
 -^-123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0-----------------------------------12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890
 5C:1051FC798C73BEA8AFEACAFEEAD121B6C9C789B0AF3594A9BB2CE949D1E208CE38EB9EBE652A4E952A7DC9ED3C88E12710000000000000000000000
 5D:5EDC8B828060C4347E84BBE9B4DF93F674D7D052FA67701A8FF50BFD13F1D32EAAD98AB2AC05E8C306FB25B2EFDB9CB30D0000000000000000000000
 5E:22D4FB39EB23880B4674BCFFD06A18547EE73E7E77F1FB29C0DBFA66ED52CB8B22BBE0ED9B2A2B779C9037D7B412A389BEC60000000000000000000000
 5F:CED093A7E422F7C2F255222EE575F075B17D030EE82CC347E91A1EC3211B988A1E3B8782C94A621631984B90BD2EAB01DCB7A0000000000000000000000
 60:4D8E375EF58D1CE91ADFECD1960C3A2C228EE1259710C93AF769CB892C6A5933CB5652D10B7BE4C852991C5646F18020B2C4DC00000000000000000000000
 61:1D62E2FAFB0A77F4532ED8BB69DAA20AB918234F3E3D5C3F57BF161EF9D44BCCA00BB5613559F1AFE74C03BCB0E1818C63BC975C00000000000000000000000
 62:B3FDAE4141A01EB87D7EEF7BE85B2081ADB3D8455D37D503F972677DBA3450455447B6F366C6E85568B196E3BB65397BE2E31F13800000000000000000000000
 ->-123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0---12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890
 63:459B1A633C60EBE15888169CEADB3D92262C8CA2D30C976089773E059F023B0ACF97BBC020BEEBD9077CAD5A1178253AE8BDD5048A800000000000000000000000
 64:1B30964EC395DC24069528D54BBDA40D16E966EF9A70EB21B5B2943A321CDF10391745570CCA9420C6ECB3B72ED2EE8B02EA2735C61A000000000000000000000000
 65:ABA2B4D132A1FDA3698D91C26E1D1B92A0A159C87EE8CC44CAF747AF5C5640166862E5B580BEC70EE7B62E74579381CD8266178372842000000000000000000000000
 -^-123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0123456789ABCDEF0-------------------12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890
 66:4462D40B5A2C8B0F1C0E681377DF98FC6C0049C5E290C16368DE868FDECA5D88ED976786514C034FF05296825AE4C5B7E1F4AD5E5FA0A4C000000000000000000000000

}

type
  pfxn64 = ^tfxn64;
  tfxn64 = int64;

  pfxn128 = ^tfxn128;
  tfxn128 = packed record
    case integer of
      -1: (_Lo, _Hi: int64);
      -9: (GUID: TGUID);
      00: (b: packed array[0..15] of byte);
      01: (w: packed array[0..07] of word);
      02: (I: packed array[0..03] of integer);
  end;

  pfxn256 = ^tfxn256;
  tfxn256 = packed record
    case integer of
      -1: (_Lo, _Hi: tfxn128);
      -9: (GUID1, GUID2: TGUID);
      00: (b: packed array[0..31] of byte);
      01: (w: packed array[0..15] of word);
      02: (I: packed array[0..07] of integer);
      03: (Q: packed array[0..03] of int64);
  end;

  tfxntype = (fxn64, fxn128, fxn256);

function nfactorial(const n: integer; out fxNumber; const fntype: tfxntype): boolean;

implementation
uses fknConst;
function nfactorial(const n: integer; out fxNumber; const fntype: tfxntype): boolean;
const
  fMax: integer = (0 + 1) shl 24 or (57 + 1) shl 16 or (34 + 1) shl 8 or (20 + 1);
  fCnt: integer = $01040201;
  fd1: array[0..12] of integer = (0, $01, $02, $06, $18, $78, //0-5
    $02D0, $13B0, $9D80, $58980, $375F00, $2611500, $1C8CFC00); //6-12
  fd2_Hi: array[21..27] of integer = (2, $3C, $579, $8362, $CD4A0, $14D9849, $232F0FCB);
  fd4_Hi: array[41..57] of integer = ($00000016, $000003C1, $0000A179, $001BC0EF, //41-44
    $04E0EA0C, $E06A0E52, $29, $7B9, $17A88, $49EEBC, $EBA8F91, //45-51
    2, $9E, $2172, $72F97, $1926933, $59996C6E); //52-57
  fd5_Lo: array[47..57 + 6] of integer = ($EE4F7400, $AEE5C000, $79F9C000, $D2C78000, $FDBE8000, //51
    $02A9E063, $8D2B749B, $C72A98D8, $CA26D687, $387EED9C, $9442E7D1, //52-57hi
    $8AB20000, $B6DA0000, $91FC0000, $5D240000, $5FE00000, $58E00000); //52-57lo

  fd2: array[13..27 + (7 + 6 + 6 + 5 + 6) * 2 + 1] of int64 = ($17328CC00, $144C3B2800, $13077775800, //13-15
    $130777758000, $1437EEECD8000, $16BEECCA730000, $1B02B9306890000, $21C3677C82B40000, //16-20
    $C5077D36B8C40000, $EEA4C2B3E0D80000, $70CD7E2933680000, //20-22
    $9343D3DCD1C00000, $619FB0907BC00000, $EA37EEAC91800000, $B3E62C3358800000, //23-27
    $AD2CD59DAE000000, $9E1432DCB6000000, $865DF5DD54000000, $4560C5CD2C000000, //28-31 (low)
    $AC18B9A580000000, $2F2FEE5580000000, $445DA75B00000000, //31-34 (low)
    $BC8B95CF58CDE171, $83A111287CF3B3E4, $06477ADA0F38FFF4, //35-37 (low)
    $EE9C3C5E4275FE38, $59CD325C1FF9BA88, $080FDE64FF052540, //38-40 (low)
    $4A8A9E2CD7D2F740, $3ABDF35B689C9080, $DDE7E05A924C4580, //41-43 low
    $23DA8F91251BF200, $4D6B3C8385E98A00, $E944DFA20FF6CC00, //44-46 low
    $7F7417FDD3A50EC0, $E5C47F97AEF2C42C, $FA9C6C087C778C8D, //47-49 low2
    $F28D19A84F5973A1, $521C1C87CED2093C,
    $FEB4B180ADB5CB96, $BB68BFA3F6A3260E, $88186C96066A0711, //52-54 low
    $3D3F543B60C784D1, $65DA6CFD2BA50DE4, $ADA2445EB7C017D0, //55-57 low
    //$9C6C087C778C8D79, $8D19A84F5973A1D2,
    $00000003D925BA47, $0000006F99461A1E, $00000D13F6370F96, $0001956AD0AAE33A, //28-31 (high)
    $0032AD5A155C6748, $0688589CC0E9505E, $DE1BC4D19EFCAC82, //31-34 (high)
    $0000001E5DCBE8A8, $0000044530ACB7BA, $00009E0008F68DF5, //35-37 (high)         h
    $001774015499125E, $0392AC33E351CC76, $8EEAE81B84C7F27E, //38-40 (high)
    $E39F2C684405D62F, $581D491B28F523C2, $CCEB478FE12D019F, //41-43 low
    $38704CBAB3BC477A, $EBBD7CD198189078, $5C0C6DA95469F59D, //44-46 high
    $3378A11EE6482216, $A69E35CB2D866437, $E4484BE3B6B92EB2, //47-49 high2
    $961ED279B02B1EF4, $E823EE3E18972ACC, //50-51 high
    $FDE529A3274C649C, $90719EC722D0D480, $77F77E01580CD327, //52-54 high
    $C62C1249EAC15D7E, $59A4002B5A4C739D, $F58409A71B05BE0B, //55-57 high
    -1
    );                           

asm
@@Start: movzx ecx,cl; // not necessary if $Z4
@@begin: fldz;
  cmp al,[ecx+fmax]; movzx ecx,[ecx+fCnt];
  @@loopz: fst qword ptr [edx+ecx*8-8]; dec ecx; jnz @@loopz
  fstp st; sbb ecx,ecx; and eax,ecx; jz @@Stop
  mov ecx,[eax*4+fd1]; mov [edx],ecx
  sub eax,12; sbb ecx,ecx;
  not ecx; and eax,ecx; jmp eax*4+@@Jmptable
@@jmptable:;
  dd @@end,        @@f13, @@f14, @@f15, @@f16, @@f17, @@f18, @@f19, @@f20;
  dd @@f21, @@f22, @@f23, @@f24, @@f25, @@f26, @@f27, @@f28, @@f29, @@f30;
  dd @@f31, @@f32, @@f33, @@f34, @@f35, @@f36, @@f37, @@f38, @@f39, @@f40;
  dd @@f41, @@f42, @@f43, @@f44, @@f45, @@f46, @@f47, @@f48, @@f49, @@f50;
  dd @@f51, @@f52, @@f53, @@f54, @@f55, @@f56, @@f57//, @@f58, @@f59, @@f60;
  @@f13:; @@f14:; @@f15:; @@f16:; @@f17:; @@f18:; @@f19:; @@f20:;
    mov ecx,[eax*8+fd2-8]; mov eax,[eax*8+fd2-8+4]
    mov [edx],ecx; mov [edx+4],eax; jmp @@end
  @@f21:; @@f22:; @@f23:; @@f24:; @@f25:; @@f26:; @@f27:;
    push eax*4+48-21*4+fd2_Hi; mov ecx,[eax*8+fd2-8]; mov eax,[eax*8+fd2-8+4]
    mov [edx],ecx; pop ecx; mov [edx+4],eax; mov [edx+8],ecx; jmp @@end
  @@f52:; @@f53:; @@f54:; @@f55:; @@f56:; @@f57:;
    mov [edx],0; mov ecx,eax*4+48-47*4+fd5_Lo+6*4;
    mov [edx+4],ecx; add edx,4; jmp @@f47;
  @@f47:; @@f48:; @@f49:; @@f50:; @@f51:;
    cmp eax,51-12+1; sbb ecx,ecx; not ecx; and [edx],ecx
    mov ecx,eax*4+48-47*4+fd5_Lo; mov [edx+4],ecx;
    add edx,4; jmp @@f41;
  @@f41:; @@f42:; @@f43:; @@f44:; @@f45:; @@f46:;
    cmp eax,46-12+1; sbb ecx,ecx; not ecx; and [edx],ecx
    mov ecx,eax*4+fd4_hi-(41-12)*4; mov [edx+4*6-4],ecx; jmp @@f35;
  @@f35:; @@f36:; @@f37:; @@f38:; @@f39:; @@f40:;
    cmp eax,40-12+1; sbb ecx,ecx; not ecx; and [edx],ecx
    add edx,4; jmp @@f28;
  @@f28:; @@f29:; @@f30:; @@f31:; @@f32:; @@f33:; @@f34:;
    push esi; lea esi,[eax*8+fd2-8]; mov eax,[esi]; mov ecx,[esi+4];
    mov [edx],eax; mov [edx+4],ecx;
    mov eax,[esi+(7+6+6+5+6)*8]; mov ecx,[esi+(7+6+6+5+6)*8+4];
    mov [edx+8],eax; mov [edx+12],ecx; pop esi;
    jmp @@end
  //@@f58:; @@f59:; @@f60:;
  @@end: or eax,-1
  @@done:
@@Stop:
end;

end.

